
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://AFM-SPM.github.io/TopoStats/main/advanced/ordered_tracing/">
      
      
        <link rel="prev" href="../nodestats/">
      
      
        <link rel="next" href="../splining/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Ordered Tracing - TopoStats</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ordered-tracing" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TopoStats" class="md-header__button md-logo" aria-label="TopoStats" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TopoStats
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ordered Tracing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/AFM-SPM/TopoStats/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TopoStats" class="md-nav__button md-logo" aria-label="TopoStats" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    TopoStats
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AFM-SPM/TopoStats/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/notebooks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Notebooks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/matplotlib-style/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Matplotlib Style
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/data_dictionary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Dictionary
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Workflow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../related_software/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Related Software
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Glossary
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Contributing
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/adding_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Adding Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Advanced Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flattening/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flattening
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grain_finding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grain finding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thresholding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thresholding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../grainstats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grainstats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../disordered_tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disordered Tracing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nodestats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    NodeStats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Ordered Tracing
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Ordered Tracing
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance-traversing-a-path" class="md-nav__link">
    <span class="md-ellipsis">
      
        At a Glance : Traversing a Path
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Processing Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodestats-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeStats Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeStats Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-compile-segments" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Compile Segments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-the-nodestats-tracing-loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. The NodeStats Tracing Loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-a-simple-trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. A Simple Trace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-writhe-sign" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Writhe Sign
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topostats-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        TopoStats Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopoStats Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-classifying-circularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Classifying Circularity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-circular-and-linear-topostats-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Circular and Linear TopoStats Tracing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outputs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diagnostic Images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-uses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Possible Uses
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../splining/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Splining
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    API
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/entry_point/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Entry Point
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/filters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Filters
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/grains/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grains
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/grainstats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Grainstats
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IO
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plotting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Plotting
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/plottingfuncs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PlottingFuncs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/run_modules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Run Modules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/scars/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Scars
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/statistics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Statistics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/theme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Theme
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/thresholds/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Thresholds
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Validation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#at-a-glance-traversing-a-path" class="md-nav__link">
    <span class="md-ellipsis">
      
        At a Glance : Traversing a Path
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#processing-steps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Processing Steps
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Processing Steps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodestats-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        NodeStats Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NodeStats Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-compile-segments" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Compile Segments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-the-nodestats-tracing-loop" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. The NodeStats Tracing Loop
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-a-simple-trace" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2. A Simple Trace
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-writhe-sign" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3. Writhe Sign
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#topostats-method" class="md-nav__link">
    <span class="md-ellipsis">
      
        TopoStats Method
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TopoStats Method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-classifying-circularity" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Classifying Circularity
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-circular-and-linear-topostats-tracing" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Circular and Linear TopoStats Tracing
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    <span class="md-ellipsis">
      
        Outputs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagnostic-images" class="md-nav__link">
    <span class="md-ellipsis">
      
        Diagnostic Images
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#possible-uses" class="md-nav__link">
    <span class="md-ellipsis">
      
        Possible Uses
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="ordered-tracing">Ordered Tracing</h1>
<p>This section gives an in-depth overview of the steps taken in the ordered tracing module.</p>
<h2 id="at-a-glance-traversing-a-path">At a Glance : Traversing a Path</h2>
<p>The <code>ordered_tracing.py</code> module handles all the functions associated with ordering the pixels one-after-another from the
disordered trace (pruned skeleton).</p>
<p>The quality of the resultant metrics and ordered coordinates will depend on the ordering method chosen, whether the
skeleton matches the conformation, and if selected, the performance (pairing) of the branch crossing points in
NodeStats.</p>
<p><img alt="disordered skeleton to ordered trace" src="../../_static/images/ordered_tracing/overview.png" /></p>
<p>This module orders the disordered trace pixel-by-pixel (<code>topostats</code> method) or segment-by-segment (<code>nodestats</code> method),
giving direction to the trace and creating a path to follow. It adds the number of identified molecules (found by
restarting the trace when using the <code>nodestats</code> method) and whether the trace contains endpoints and is therefore
circular or not to the <code>all_statistics.csv</code>.</p>
<p>Some quick FYI's:</p>
<ul>
<li><strong>Multiple molecules</strong> - By design the <code>topostats</code> ordering method will only produce a single ordered trace per grain,
  however, the <code>nodestats</code> method may identify multiple (useful for separating overlapping structures etc).</li>
<li><strong>No skeletons in image</strong> - The Ordered Traces <code>all</code> image set may not show the resultant skeletons if the plotting
  <code>dpi</code> value is too low (varies based on image size) as these single pixel lines cannot be resolved by matplotlib.</li>
<li><strong>Circular field not circular</strong> - The grain stats (and molecule stats) field labelled "circular" does not check if the
  path starts and ends at the same place. Instead, it is a True/False indicator of the presence of any endpoints.</li>
<li><strong>Failed NodeStats ordering</strong> - If the "nodestats" method is selected in the configurations file and an error occurs
  in the NodeStats module for a particular grain, and that grain isn't added to the noodestats dictionary, it will
  default to "topostats" ordering.</li>
<li><strong>Overlapping traces</strong> - Because the crossing region is shared by both crossing strands, the pixels in the mask may
  show a discontinuity in one "leg" of the crossing in the ordered trace image, this is purely visual and does not
  affect the underlying data.</li>
</ul>
<h2 id="processing-steps">Processing Steps</h2>
<h3 id="nodestats-method">NodeStats Method</h3>
<h4 id="1-compile-segments">1. Compile Segments</h4>
<p>The first stage is to use the branch coordinates and disordered trace skeleton to compile a labelled image and
associated set of coordinates and their stacking orders. To do this, the crossing branch coordinates are removed from
the disordered trace and all remaining segments labelled 1 to N. Then, branch-by-branch the crossing coordinates are
replaced with following labels, resulting in an image where each skeleton and crossing segment are labelled.</p>
<p><img alt="Disordered trace segment image" src="../../_static/images/ordered_tracing/ns_segments.png" /></p>
<h4 id="2-the-nodestats-tracing-loop">2. The NodeStats Tracing Loop</h4>
<p>The trace aims to use the labelled segments described above to link to the full set of coordinates and build,
segment-by-segment, an ordered path.</p>
<p>It starts by looking for any endpoints, and uses the index of the endpoint segment to start the trace, if there are no
endpoints, the starting index will all ways be the first labelled index (1 in the image, 0 in the coordinate list) -
this also has the advantage of starting from a non-crossing segment. The coordinates are added to the ordered trace and
the currently indexed segment is then removed from the guide image containing all the segments. Then, the maximum value
found in a 3x3 area around the final coordinate in the ordered trace is used to identify the following trace
segment. This repeats until a segment terminates and the only values in that 3x3 area are 0's (background).</p>
<p><img alt="Trace segment image &amp; next index selector" src="../../_static/images/ordered_tracing/ns_tracing.png" /></p>
<p>If there are no more remaining segments, the trace is finished. However, if any segments remain, a new ordered trace is
started, again from an endpoint segment if possible, hence why this method is able to untangle two interlinked molecules
such as DNA catenanes.</p>
<p><img alt="Two molecule trace" src="../../_static/images/ordered_tracing/ns_sep_mols.png" /> *Skeletons dilated for visual aid</p>
<h4 id="22-a-simple-trace">2.2. A Simple Trace</h4>
<p>While the above is happening, ordered trace segment coordinates are also being added to a simplified ordered trace to be
used with the <a href="https://topoly.cent.uw.edu.pl/documentation.html">Topoly</a>package to determine it's topological species. A
pseudo Z (height) is used to distinguish between skeleton segments (Z=0) and crossing segments (Z=-1, 1, 2...). However,
these traces (N, X, Y, Z) can be too long and cause Topoly to hang, so they are reduced to ~100 coordinates. Each
reduced points of each segments ensure the points capture the start and end of each segment.</p>
<p><img alt="3D simple trace" src="../../_static/images/ordered_tracing/ns_3d.png" /></p>
<p>Topoly then uses this NXYZ coordinate trace to produce a topological classification using Homfly polynomials. In
addition, another trace is built up which flips the stacking order of the lowest confidence crossing to generate a
secondary topology.</p>
<ul>
<li>Future work may aim to ensure these reduced segments don't accidentally cross.</li>
</ul>
<h4 id="23-writhe-sign">2.3. Writhe Sign</h4>
<p>The ordered trace and crossing branch coordinates are also used to calculate the writhe of each crossing via the cross
product of the branches normalised vectors, with their direction following the path of the trace. The writhe sign is
calculated as "+" or "-". If a crossing contains &gt; 2 crossing branches, the single crossing region is split into pairs
and the writhe calculated in brackets i.e. "+(-++)"</p>
<p><img alt="ordered img, crossing img and sign" src="../../_static/images/ordered_tracing/ns_writhe.png" /></p>
<p>For overlapping molecules, the writhe signs are still calculated but this is greatly dependent on the directionality of
each molecule. In the case of DNA catenanes, a positive or negative writhe would depend on the relative direction of
each trace. In these cases, the writhe string should only be used to observe relative writhe signs i.e. "++-+" equals
"--+-", as directionality cannot be observed in AFM images.</p>
<ul>
<li>Future work may be to separate self and intra-molecule writhes.</li>
</ul>
<h3 id="topostats-method">TopoStats Method</h3>
<h4 id="1-classifying-circularity">1. Classifying Circularity</h4>
<p>The TopoStats tracing algorithms slightly differ depending on whether the trace is circular or not. The disordered trace
is defined as circular by counting the number of neighbours of each pixel in the skeleton. If a skeleton contains at
least one skeleton with only one neighbour it is defined as non-circular.</p>
<p><img alt="circular vs linear trace" src="../../_static/images/ordered_tracing/ts_circular.png" /></p>
<h4 id="2-circular-and-linear-topostats-tracing">2. Circular and Linear TopoStats Tracing</h4>
<p>If the disordered trace is not deemed circular, the trace starts by first finding and selecting an endpoint (pixel with
one neighbour).</p>
<p>If the disordered trace is deemed circular, the trace starts by first finding and selecting a point with two
neighbours. Then, the selected coordinate is added to the ordered path, and deleted from the skeleton. One of the
neighbouring points are randomly selected.</p>
<p>The selected point is then added to the path and deleted from the skeleton enabling the path to then follow the sole
remaining pixel to traverse the path. However, above assumes there is always only one pixel to follow around the path,
but if there are more, the trace will look up to 4 pixels earlier in the ordered trace, and try to identify the next
pixel which has the lowest angular change.</p>
<p><img alt="pixel diagram making the trace" src="../../_static/images/ordered_tracing/ts_trace.png" /></p>
<h2 id="outputs">Outputs</h2>
<p>The <code>&lt;image&gt;_&lt;threshold&gt;_ordered_traces</code> image shows the direction of ordered coordinates.</p>
<p>For each grain, the following new columns are added to the <code>grainstats.csv</code> file:</p>
<table>
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>num_molecules</code></td>
<td>The number of molecules found by following the tracing paths. Note: This will always be 1 for the TopoStats method.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>circular</code></td>
<td>Whether the disordered trace contains an endpoint.</td>
<td><code>bool</code></td>
</tr>
<tr>
<td><code>writhe_string</code></td>
<td>The writhe sign (+/-) which describes the crossing directionality. If a crossing contains &gt; 2 crossing branches, the single crossing region is split into pairs and the writhe calculated in brackets i.e. "+(-++)".</td>
<td><code>str</code></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><img alt="Ordered tracing grain metrics visualisation" src="../../_static/images/ordered_tracing/ts2_ord_metrics.png" /></p>
<p>For each molecule found by the ordering algorithm(s), the following new columns are added to the <code>molstats.csv</code> file:</p>
<table>
<thead>
<tr>
<th>Column Name</th>
<th>Description</th>
<th>Data Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>circular</code></td>
<td>The number of molecules found by following the tracing paths. Note: This will always be 1 for the TopoStats method.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>topology</code></td>
<td>Whether the disordered trace contains an endpoint.</td>
<td><code>bool</code></td>
</tr>
<tr>
<td><code>topology_flip</code></td>
<td>The number of molecules found by following the tracing paths. Note: This will always be 1 for the TopoStats method.</td>
<td><code>integer</code></td>
</tr>
<tr>
<td><code>processing</code></td>
<td>The method used for ordering.</td>
<td><code>str</code></td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<p><img alt="Ordered tracing molecule metrics visualisation" src="../../_static/images/ordered_tracing/ts2_metrics-mols.png" /></p>
<p>Note: Most information obtained during the Ordered Tracing processing can be obtained from the <code>&lt;image_name&gt;.topostats</code>
file found within the <code>processed</code> folder and contains a multitude of molecule related objects such as:</p>
<ul>
<li>bounding box</li>
<li>cumulative distance along the trace</li>
<li>height along the trace</li>
<li>the ordered coordinates</li>
<li>molecule statistics explained above</li>
<li>The writhe sign for each crossing is added to the NodeStats dictionary.</li>
</ul>
<p><img alt="TopoStats file - NodeStats structure" src="../../_static/images/ordered_tracing/topostats_file.png" /></p>
<h2 id="diagnostic-images">Diagnostic Images</h2>
<p>Images produced by the <code>plotting.image_set: all</code> for this module are:</p>
<ul>
<li><code>27-trace_segments</code> - The labelled skeleton and crossing segments that the NodeStats trace is built from.</li>
<li><code>28-all_molecule_crossings</code> - The skeleton, underlying and overlying crossing segments in blue, pink and green
  respectively. The colourmap used is three-tone meaning that middle crossing branches when there are more than two
  branches will appear blue too.</li>
<li><code>29-all_molecules</code> - A labelled image of all the identified molecules in the grain found by the ordering method. In
  the default colourmap, only three traces will show - blue, green, and pink.</li>
</ul>
<p><img alt="Examples of diagnostic images" src="../../_static/images/ordered_tracing/diagnostics.png" /></p>
<h2 id="possible-uses">Possible Uses</h2>
<p>This module would lend itself useful for separating overlapping or intertwined structures, and is a requirement for the
<code>splining</code> module which smooths the ordered traces to obtain contour lengths of individual molecules.</p>
<p>Additionally, you could use this module and the writhe string obtained to assess the supercoiling degree (via writhe
only, not twist) in DNA samples as well as a preliminary step to obtaining the lengths of the individual molecules.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>